# WhatsNew Site

Public, client-only viewer for changelog JSON files generated by [`whatsnew`](https://github.com/whatsnew-dev/whatsnew) and published to a repository's `gh-pages` branch. Built with Next.js App Router, Tailwind CSS, and shadcn/ui, it renders the latest release or any tagged release without a backend.

## Quick start

```bash
npm install
npm run dev
```

Visit `http://localhost:3000` and load a changelog by navigating to:

- `/{owner}/{repo}` – fetches `data/latest.json`
- `/{owner}/{repo}/releases/{tag}` – fetches `data/releases/{tag}.json`

Data is pulled directly from `https://raw.githubusercontent.com/{owner}/{repo}/gh-pages/` at request time. No environment variables or server runtime are required.

## Data contract

The viewer expects the following JSON structures:

```ts
// data/latest.json or data/releases/<tag>.json
export type ChangeItem = {
  summary: string;
  refs?: string[];
  class?: "feature" | "fix" | "perf" | "docs" | "security" | "breaking" | "internal";
};

export type Section = { title: string; items: ChangeItem[] };

export type Changelog = {
  repo: string;
  tag?: string;
  released_at?: string;
  range: { mode: string; from?: string; to?: string };
  stats?: { commits?: number; prs?: number };
  sections: Section[];
};

// optional data/site.config.json
export type SiteCfg = {
  title?: string;
  logo?: string;      // URL to an image asset
  accent?: string;    // CSS color value (hex, rgb, etc.)
  intro_markdown?: string;
};
```

`internal` class items are hidden automatically. The `accent` value (if provided) is applied to buttons, badges, and headings.

## UI components

- **Header** – renders title/logo/intro markdown plus a GitHub link
- **ReleaseCard** – shows release metadata, change count, and an accordion of sections
- **SectionList** – groups change items per section with icons and badges
- **BadgeForClass** – maps change classes to shadcn badges and colors

All components live under `components/` for reuse and testing.

## Project layout

```
app/
  [owner]/[repo]/page.tsx          # Latest release view
  [owner]/[repo]/releases/[tag]/   # Specific release view
components/
  Header.tsx, ReleaseCard.tsx, SectionList.tsx, BadgeForClass.tsx, ErrorNotice.tsx
lib/
  fetch.ts, types.ts, utils.ts
styles/
  app/globals.css (Tailwind 4 entrypoint)
```

## Deployment

Deploy on Vercel using the standard Next.js preset:

```bash
npm run build
vercel --prod
```

Because the app relies exclusively on client-side fetches to `raw.githubusercontent.com`, no serverless functions or environment configuration is required. Ensure the target repository publishes the following files to `gh-pages`:

- `data/latest.json`
- `data/releases/<tag>.json`
- (optional) `data/site.config.json`

Once published, share URLs such as `https://your-vercel-app.vercel.app/vercel/next.js` for the latest changes or append `/releases/v1.2.3` for a specific tag.
